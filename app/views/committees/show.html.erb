
<p> <%= @committee.committee_name %> Committee </p>
<% if show_start_button?(current_user, @committee) %>
    <%= form_with url: meeting_new_path, method: :post do |form|%>
        <%= form.text_field :meeting_title, placeholder: "Meeting Title" %>
        <%= hidden_field_tag "committee_id", @committee.id %>
        <%= form.submit "Start Meeting Sign-In" %>
    <% end %>
<% end %>

<% if show_end_button?(current_user, @committee) %>
    <%= form_with url: end_meeting_path(@committee.current_meeting.id), method: :post do |form|%>
        <%= form.submit "End Meeting Sign-In" %>
    <% end %>
<% end %>

<% if show_sign_in_notice?(current_user, @committee) %>
    <p>There is currently a meeting signin period:</p>
    <%= link_to "Sign in", meeting_path(@committee.current_meeting.id) %>
<% end %>

Committee Senators
<table>
  <thead>
    <tr>
      <th>Senator</th>
      <th>Number of Absences</th>
      <th>Excused Absences</th>
      <th>Unexcused Absences</th>
    </tr>
  </thead>

  <tbody>
    <% @committee.users.each do |user| %>
      <tr>
        <td><%= user.name %></td>
        <td><%= AttendanceRecord.find_total_absences(user.committee_enrollments) %></td>
        <td><%= AttendanceRecord.find_total_excused_absences(user.committee_enrollments) %></td>
        <td><%= AttendanceRecord.find_total_absences(user.committee_enrollments) -  AttendanceRecord.find_total_excused_absences(user.committee_enrollments) %></td>
        <td><%= link_to 'Show User', user %></td>
      </tr>
    <% end %>
  </tbody>
</table>
<%= link_to "Show All Senators", users_path(committee_id: @committee.id) %>
<br>
Committee Meetings
<table>
  <thead>
    <tr>
      <th>Meeting Title</th>
      <th>Meeting Start Time</th>
      <th>Meeting End Time</th>
      <th></th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @committee.meetings[0...4].each do |meeting| %>
      <tr>
        <td><%= meeting.title %></td>
        <td><%= meeting.start_time.to_formatted_s(:short) %></td>
        <td><%= meeting.end_time.to_formatted_s(:short) %></td>
        <td><%= link_to "Show Meeting", meeting_path(meeting.id) %></td>
      </tr>
    <% end %>
  </tbody>
</table>
<%= link_to "Show All Meetings", meetings_path(committee_id: @committee.id) %>
<br>
<% if show_committee_excuses_link?(current_user, @committee) %>
    <%= link_to "Committee Excuses", excuses_path(committee_id: @committee.id) %>
<% end %>

<% if show_edit_committee_link?(current_user, @committee) %>
    | <%= link_to "Edit Committee", edit_committee_path(@committee.id) %>
<% end %>

<% if show_delete_committee_link?(current_user) %>
    | <%= link_to "Delete Committee", @committee, method: :delete, data: { confirm: 'Are you sure?' } %>
<% end %>
